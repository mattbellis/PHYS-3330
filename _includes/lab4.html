<html>
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <meta name="generator" content="pandoc">
      <meta name="author" content="Department of Physics | University of Colorado Boulder">
      
      <title>PHYS 3330</title>
         </head>
   <body>
            <div>
         <style>
            .eqnos { display: inline-block; position: relative; width: 100%; }
            .eqnos br { display: none; }
            .eqnos-number { position: absolute; right: 0em; top: 50%; line-height: 0; }
         </style>
         <h1 class="title">Lab 4 - Operational Amplifiers (OP-Amps) I</h1>
                  <h1 class="title">Contents</h1>
        <nav id="TOC">
            <ul>
            <li><a href="#goals"><span class="toc-section-number">1</span> Goals</a></li>
            <li><a href="#prelab"><span class="toc-section-number">2</span> Prelab</a>
            <ul>
            <li><a href="#op-amps"><span class="toc-section-number">2.1</span> Op-amps</a></li>
            <li><a href="#open-loop-gain"><span class="toc-section-number">2.2</span> Open Loop Gain</a>
            <ul>
            <li><a href="#sec:1.1"><span class="toc-section-number">2.2.1</span> Prelab Question</a></li>
            </ul></li>
            <li><a href="#input-impedance"><span class="toc-section-number">2.3</span> Input impedance</a>
            <ul>
            <li><a href="#sec:2.1"><span class="toc-section-number">2.3.1</span> Prelab Question</a></li>
            </ul></li>
            <li><a href="#output-current"><span class="toc-section-number">2.4</span> Output current</a>
            <ul>
            <li><a href="#sec:2.2"><span class="toc-section-number">2.4.1</span> Prelab Question</a></li>
            </ul></li>
            <li><a href="#intro-to-negative-feedback"><span class="toc-section-number">2.5</span> Intro to negative feedback</a>
            <ul>
            <li><a href="#sec:3.1"><span class="toc-section-number">2.5.1</span> Prelab Question</a></li>
            <li><a href="#sec:3.2"><span class="toc-section-number">2.5.2</span> Prelab Question</a></li>
            </ul></li>
            <li><a href="#negative-feedback-continued"><span class="toc-section-number">2.6</span> Negative feedback continued</a>
            <ul>
            <li><a href="#sec:4.1"><span class="toc-section-number">2.6.1</span> Prelab Question</a></li>
            </ul></li>
            <li><a href="#non-inverting-amplifier"><span class="toc-section-number">2.7</span> Non-Inverting Amplifier</a>
            <ul>
            <li><a href="#sec:5.1"><span class="toc-section-number">2.7.1</span> Prelab Question</a></li>
            <li><a href="#sec:5.2"><span class="toc-section-number">2.7.2</span> Prelab Question</a></li>
            <li><a href="#sec:5.3"><span class="toc-section-number">2.7.3</span> Prelab Question</a></li>
            </ul></li>
            <li><a href="#input-and-output-impedance-of-the-non-inverting-amplifier"><span class="toc-section-number">2.8</span> Input and Output Impedance of the Non-Inverting Amplifier</a>
            <ul>
            <li><a href="#sec:6.1"><span class="toc-section-number">2.8.1</span> Prelab Question</a></li>
            <li><a href="#sec:6.2"><span class="toc-section-number">2.8.2</span> Prelab Question</a></li>
            <li><a href="#sec:6.3"><span class="toc-section-number">2.8.3</span> Prelab Question</a></li>
            </ul></li>
            <li><a href="#powering-the-op-amp"><span class="toc-section-number">2.9</span> Powering the op-amp</a>
            <ul>
            <li><a href="#sec:7.1"><span class="toc-section-number">2.9.1</span> Prelab Question</a></li>
            <li><a href="#sec:7.2"><span class="toc-section-number">2.9.2</span> Prelab Question</a></li>
            <li><a href="#sec:7.3"><span class="toc-section-number">2.9.3</span> Prelab Question</a></li>
            </ul></li>
            <li><a href="#lab-activities"><span class="toc-section-number">2.10</span> Lab activities</a>
            <ul>
            <li><a href="#sec:8.1"><span class="toc-section-number">2.10.1</span> Prelab Question</a></li>
            </ul></li>
            </ul></li>
            <li><a href="#op-amp-tldr"><span class="toc-section-number">3</span> Op-amp TLDR</a>
            <ul>
            <li><a href="#golden-rules"><span class="toc-section-number">3.1</span> Golden Rules</a></li>
            <li><a href="#definitions"><span class="toc-section-number">3.2</span> Definitions</a></li>
            </ul></li>
            <li><a href="#useful-readings"><span class="toc-section-number">4</span> Useful Readings</a></li>
            <li><a href="#ic-tips"><span class="toc-section-number">5</span> IC Tips</a></li>
            <li><a href="#lab-activities-1"><span class="toc-section-number">6</span> Lab Activities</a>
            <ul>
            <li><a href="#the-function-generator-and-its-output-impedance."><span class="toc-section-number">6.1</span> The Function Generator and Its Output Impedance.</a></li>
            <li><a href="#building-an-op-amp-test-circuit"><span class="toc-section-number">6.2</span> Building an op-amp test circuit</a></li>
            <li><a href="#voltage-buffer"><span class="toc-section-number">6.3</span> Voltage Buffer</a></li>
            <li><a href="#non-inverting-amplifier-1"><span class="toc-section-number">6.4</span> Non-Inverting Amplifier</a>
            <ul>
            <li><a href="#frequency-limitations-of-the-amplifier"><span class="toc-section-number">6.4.1</span> Frequency limitations of the amplifier</a></li>
            <li><a href="#output-voltage-limitations-of-the-amplifier"><span class="toc-section-number">6.4.2</span> Output voltage limitations of the amplifier</a></li>
            <li><a href="#input-impedance-of-the-amplifier"><span class="toc-section-number">6.4.3</span> Input impedance of the amplifier</a></li>
            <li><a href="#output-impedance-of-the-amplifier"><span class="toc-section-number">6.4.4</span> Output impedance of the amplifier</a></li>
            </ul></li>
            </ul></li>
            </ul>
        </nav>
        <hr/>
         <h1 data-number="1" id="goals"><span class="header-section-number">1</span> Goals</h1>
         <p>In this lab you will get your first exposure with op-amps and use them to build two incredibly useful circuits: the voltage buffer (aka voltage follower), and the non-inverting amplifier. These two circuits are closely related and are used in many applications.</p>
         <p>Op-amps serve many purposes, but one of the main uses is to amplify a small signal by increasing the voltage level while preserving as accurately as possible the original waveform. In real physics experiments, transducers are used to convert basic physical quantities into electric signals, as shown in Figure <a href="#fig:lab-measurement">1</a>. An amplifier is usually needed to raise the small transducer voltage (μV to mV) to a useful level (mV to V) for the signal to be measured reliably.</p>
         <div id="fig:lab-measurement" class="fignos">
         <figure>
         <img src="../resources/lab4fig/lab-measurement.png" alt="" /><figcaption><span>Figure 1:</span> Typical laboratory measurement system</figcaption>
         </figure>
         </div>
         <p>Even though there are commercial amplifiers available for purchase, they are often very expensive (&gt;$1000) and have many features that may not be needed. Meanwhile, you can design your own simple amplifier with an op-amp which could cost less than a dollar.</p>
         <p>To prepare for this lab, you will learn to apply new analysis techniques (the op-amp golden rules) to predict the behavior and inform the design of op-amp circuits. In this lab, you will:</p>
         <ul>
         <li><p>Explore obstacles due to the function generator’s output impedance.</p></li>
         <li><p>Learn how to easily test an op-amp to see if it’s working.</p></li>
         <li><p>Build a voltage buffer (follower) to</p>
         <ul>
         <li>provide a voltage with low output impedance,</li>
         <li>test the maximum output current of the LF356 op-amp.</li>
         </ul></li>
         <li><p>Build a non-inverting amplifier to amplify small signals and test</p>
         <ul>
         <li>the gain,</li>
         <li>the frequency dependence,</li>
         <li>the maximum output voltages,</li>
         <li>the effects of resistors in series with the input,</li>
         <li>the output impedance and its effects on driving a load.</li>
         </ul></li>
         </ul>
         <h1 data-number="2" id="prelab"><span class="header-section-number">2</span> Prelab</h1>
         <h2 data-number="2.1" id="op-amps"><span class="header-section-number">2.1</span> Op-amps</h2>
         <blockquote>
         <p>The op-amp is, essentially, a “perfect part”: a complete integrated amplifier gain block, best thought of as a dc-coupled differential amplifier with single-ended output, and with extraordinarily high gain. It also excels in precise input symmetry and nearly zero input current. Op-amps are designed as “gain engines” for negative feedback, with such high gain that the circuit performance is set almost entirely by the feedback circuitry. Op-amps are small and inexpensive, and they should be the starting point for nearly every analog circuit you design. In most op-amp circuit designs we’re in the regime where they are essentially perfect: with them we will learn to build nearly perfect amplifiers, current sources, integrators, filters, regulators, current-to voltage converters, and a host of other modules. (Horowitz and Hill 3<sup>rd</sup> Ed. 223)</p>
         </blockquote>
         <p>In this lab, you will use op-amps to build a voltage buffer and a non-inverting amplifier. Op-amps are ICs (integrated circuits) made up of many transistors. Most textbooks discuss transistors prior to op-amps; we are going in the opposite order because we are not particularly interested in how op-amps are designed and the details of the inner workings (however, this could be explored in a final project). When considering how op-amps work at a higher level, the analysis is often far easier than that of transistor circuits. The <strong><em>GOLDEN RULES</em></strong> can be used to solve most op-amp circuits with relative ease; these golden rules are approximations (which most of the time are quite accurate) that greatly reduce the complexity of op-amp circuit analysis.</p>
         <h2 data-number="2.2" id="open-loop-gain"><span class="header-section-number">2.2</span> Open Loop Gain</h2>
         <div id="fig:opamp-man" class="fignos">
         <figure>
         <img src="../resources/lab4fig/op-amp-man.png" style="width:15cm" alt="" /><figcaption><span>Figure 2:</span> Op-amp “black-box” schematic. We can imagine someone inside the op-amp looking at the the voltage difference between the inputs and using this to set <span class="math inline">\(V_\text{out}^\text{(internal)}.\)</span></figcaption>
         </figure>
         </div>
         <p>The op-amp has two inputs (inverting and non-inverting) and one output. It can be thought of as a “black-box” (as seen in Figure <a href="#fig:opamp-man">2</a>) which has an internal voltage source that is controlled by the potential difference between the non-inverting input and the inverting input. The op-amp’s output is the difference between the inputs times <strong>the open-loop gain</strong> <span class="math inline">\(A\)</span>.</p>
         <p><span class="math display">\[V_\text{out} = A (V_+-V_-)\]</span></p>
         <p>Note that this is true when there is no voltage drop across <span class="math inline">\(R_o\)</span>. Op-amps have very small output impedance, and for an ideal op-amp, <span class="math inline">\(R_o=0\)</span>.</p>
         <p><strong>Definition 1: Open-loop gain, <span class="math inline">\(A\)</span></strong> - the gain of the op-amp when there is no feedback.</p>
         <p>The open-loop gain depends on frequency according to the following equation:</p>
         <p><span class="math display">\[A(f) = \frac{A_\text{VOL}}{1+j\frac{f}{f_0}}\]</span></p>
         <p>where <span class="math inline">\(A_\text{VOL}\)</span> is the <strong>open-loop DC gain</strong> and <span class="math inline">\(f_0\)</span> is the <strong>open-loop 3 dB point</strong>. Notice that this is the same kind of equation as a low-pass filter. At low frequencies, this equation is flat and equal to <span class="math inline">\(A_\text{VOL}\)</span>, but near the 3 dB point, it starts to drop (this drop is typically described in dB/octave or dB/decade) and can be reported in strange units like V/mV (which is essentially a weird way of writing <span class="math inline">\(10^3\)</span>).</p>
         <p><strong>Definition 2: Open-loop DC gain, <span class="math inline">\(A_\text{VOL}\)</span></strong> - The open-loop gain at low frequencies before the frequency dependence starts to take over and the open-loop gain starts to decrease. This is cited in any op-amp datasheet (sometimes as <span class="math inline">\(A_\text{OL}\)</span> or <span class="math inline">\(A_\text{VO}\)</span>).</p>
         <p><strong>Definition 3: Open-loop 3 dB point, <span class="math inline">\(f_0\)</span></strong> - The frequency that the open-loop gain falls -3 dB from <span class="math inline">\(A_\text{VOL}\)</span>. Beyond this frequency, <span class="math inline">\(A\)</span> typically continues to fall with a constant dB per log-scale (quoted in dB/octave (log2) or dB/decade (log10)). This value is usually <strong><em>not</em></strong> quoted in datasheets. It can be calculated from other values, and people often aren’t concerned with the value of <span class="math inline">\(f_0\)</span>.</p>
         <p>An ideal op-amp has an <strong>open-loop gain</strong> of infinity and does <em>not</em> depend on frequency. Treating the gain as infinite is usually a really good approximation because real op-amps have open-loop gain values of <span class="math inline">\(10^5-10^8\)</span>. This approximation is known as the first <strong><em>GOLDEN RULE</em></strong> of op-amps.</p>
         <p><strong>GOLDEN RULE 1:</strong> The open-loop gain is infinitely large: <span class="math inline">\(A\rightarrow\infty\)</span>.</p>
         <h3 data-number="2.2.1" id="sec:1.1"><span class="header-section-number">2.2.1</span> Prelab Question</h3>
         <p>In this lab, you will be using the LF356 op-amp. Open up its datasheet on the <a href="/PHYS-3330/manuals-data-sheets">Datasheets and Instrument Manuals page</a>. You should keep this open, as you’ll refer to it multiple times throughout the prelab and lab activities. Starting on page 2 there are tables with values for various properties of this op-amp and other closely related op-amps (make sure you pull values from the right column).</p>
         <p>What is the open-loop DC gain, <span class="math inline">\(A_\text{VOL}\)</span>? Report it as a unitless number.</p>
         <h2 data-number="2.3" id="input-impedance"><span class="header-section-number">2.3</span> Input impedance</h2>
         <p>Op-amps have input terminals that are designed to have very large input impedances (<span class="math inline">\(R_i\)</span> in Figure <a href="#fig:opamp-man">2</a>), such that virtually no current can flow into or out of the inputs. The second <strong><em>GOLDEN RULE</em></strong> assumes that the input impedance is infinitely large and <strong><em>no</em></strong> current flows in or out of the inputs.</p>
         <p><strong>GOLDEN RULE 2:</strong> No current flows in or out of the inputs: <span class="math inline">\(I_+=I_-=0\)</span>.</p>
         <h3 data-number="2.3.1" id="sec:2.1"><span class="header-section-number">2.3.1</span> Prelab Question</h3>
         <p>According to the datasheet, what is the input impedance (resistance) <span class="math inline">\(R_i\)</span>?</p>
         <h2 data-number="2.4" id="output-current"><span class="header-section-number">2.4</span> Output current</h2>
         <p>Op-amps have very low output impedances (<span class="math inline">\(R_o\)</span> in Figure <a href="#fig:opamp-man">2</a>) allowing them to efficiently drive loads (think back to the input and output impedance considerations from lab 2). However, regardless of the output impedance, there is current limit inherent to each op-amp design. The current limit (maximum output current) is an important consideration when it comes to the ability of an op-amp to drive a load.</p>
         <h3 data-number="2.4.1" id="sec:2.2"><span class="header-section-number">2.4.1</span> Prelab Question</h3>
         <p>What is the maximum output positive current at <span class="math inline">\(0\text{ V}\)</span> for a supply voltage of <span class="math inline">\(\pm 15 \text{ V}\)</span> at <span class="math inline">\(25 ^{\circ} \text{C}\)</span> (look for a graph on page 5)?</p>
         <h2 data-number="2.5" id="intro-to-negative-feedback"><span class="header-section-number">2.5</span> Intro to negative feedback</h2>
         <p>Negative feedback is at the heart of nearly every op-amp circuit. The op-amp itself doesn’t have negative feedback; it has to be externally applied by feeding back part of (or all of) the output voltage back into the inverting input <span class="math inline">\(V_-\)</span>. Negative feedback results in a circuit with a <strong>closed-loop gain</strong>, <span class="math inline">\(G&lt;A\)</span>, which depends on the amount of <span class="math inline">\(V_\text{out}\)</span> that is fed back into <span class="math inline">\(V_-\)</span>. The feedback also improves the linearity and stability of the output and greatly increases the bandwidth: the <strong>3 dB point</strong> <span class="math inline">\(f_b &gt; f_0\)</span>. In fact, the bandwidth times the DC gain is a constant value called the <strong>gain bandwidth product</strong> (<span class="math inline">\(\text{GBW}\)</span>), so the smaller the gain, the wider the bandwidth. When the gain is 1, the 3 dB point is equal to the <span class="math inline">\(\text{GBW}\)</span> and is referred to as the <strong>unity gain frequency</strong>, <span class="math inline">\(f_T\)</span> (unity means 1). Often <strong>unity gain frequency</strong> and <strong>gain bandwidth product</strong> are used interchangeably since they are mathematically the same value. All these values can be related to each other with the following equations:</p>
         <p><span class="math display">\[\text{GBW} = G_0 f_B = 1\cdot f_T = A_\text{VOL}f_0\]</span></p>
         <p>The frequency dependence of <span class="math inline">\(G\)</span> follows the same form as for <span class="math inline">\(A\)</span>, but with a larger bandwidth:</p>
         <p><span class="math display">\[G(f)=\frac{G_0}{1+j\frac{f}{f_B}}\]</span></p>
         <p><strong>Definition 4: Closed-loop gain, <span class="math inline">\(G\)</span></strong> - when a fraction of the output is fed back into the inverting input <span class="math inline">\(V_-\)</span>, the op-amp’s gain is greatly reduced from <span class="math inline">\(A\)</span> to some value <span class="math inline">\(G\)</span>. Just like the open-loop gain, this value is frequency dependent and starts to fall from <span class="math inline">\(G_0\)</span> near the 3 dB point, <span class="math inline">\(f_B\)</span>.</p>
         <p><strong>Definition 5: Closed-loop DC gain, <span class="math inline">\(G_0\)</span></strong> - the closed-loop gain at frequencies well below the 3 dB point. Except in active filter design, the point of an op-amp is to operate at a frequency such that <span class="math inline">\(G(f)=G_0\)</span>, so almost always, the closed-loop DC gain is referred to simply as <strong><em>THE</em> gain</strong>.</p>
         <p><strong>Definition 6: 3 dB point, <span class="math inline">\(f_B\)</span></strong> - the frequency where <span class="math inline">\(G\)</span> drops -3 dB from <span class="math inline">\(G_0\)</span>. This is also often referred to as the bandwidth or operating bandwidth, as typical operation should be done below this frequency.</p>
         <p><strong>Definition 7: gain bandwidth product, <span class="math inline">\(\text{GBW}\)</span></strong> - the product of the DC gain and the 3 dB point is a constant value. This should be cited in datasheets as it’s a foundational property of each op-amp’s internal design. Just like resistor values, however, the precise <span class="math inline">\(\text{GBW}\)</span> varies from op-amp to op-amp of the same name.</p>
         <p><strong>Definition 8: unity gain frequency, <span class="math inline">\(f_T\)</span></strong> - the 3 dB point when the gain is 1 (unity). Since this is mathematically equivalent to the <span class="math inline">\(\text{GBW}\)</span>, these terms are often used interchangeably.</p>
         <h3 data-number="2.5.1" id="sec:3.1"><span class="header-section-number">2.5.1</span> Prelab Question</h3>
         <p>Find the gain bandwidth product in the datasheet. Report this property, and calculate <span class="math inline">\(f_0\)</span> using the open-loop DC gain found earlier in the datasheet.</p>
         <h3 data-number="2.5.2" id="sec:3.2"><span class="header-section-number">2.5.2</span> Prelab Question</h3>
         <p>Create a Bode plot (which is a log-log plot of a property vs frequency) for the magnitude of various gain values shown above. (The template from last week’s lab should be useful here).</p>
         <ul>
         <li><p>On the same log-log plot, plot <span class="math inline">\(|G(f)|\)</span> for <span class="math inline">\(G_0=1\)</span>, <span class="math inline">\(100\)</span>, <span class="math inline">\(1000\)</span>, and <span class="math inline">\(A_\text{VOL}\)</span> (as found in the datasheet)</p></li>
         <li><p>It will help to express <span class="math inline">\(|G(f)|\)</span> in terms of the <span class="math inline">\(\text{GBW}\)</span> (or <span class="math inline">\(f_T\)</span>), instead of with respect to <span class="math inline">\(f_B\)</span>. This will simplify the Python function.</p></li>
         <li><p>Make the range of the x-axis from <span class="math inline">\(1\text{ Hz}-100\text{ MHz}\)</span></p></li>
         </ul>
         <p><em>Hint:</em> <span class="math inline">\(G(f)\)</span> is complex, so to find it’s magnitude you have to calculate <span class="math inline">\(\sqrt{GG^*}\)</span> where <span class="math inline">\(G^*\)</span> is the complex conjugate.</p>
         <h2 data-number="2.6" id="negative-feedback-continued"><span class="header-section-number">2.6</span> Negative feedback continued</h2>
         <p>Negative feedback also brings us to the third <strong><em>GOLDEN RULE</em></strong>:</p>
         <p><strong>GOLDEN RULE 3:</strong> Negative feedback forces the voltage at the inverting input to equal the voltage at the non-inverting input; <span class="math inline">\(V_+=V_-\)</span>.</p>
         <p>Again, this an approximation. In reality <span class="math inline">\(V_+\approx V_-\)</span>; for there to be any <span class="math inline">\(V_\text{out}\)</span>, there has to be small differences between <span class="math inline">\(V_+\)</span> and <span class="math inline">\(V_-\)</span>.</p>
         <p>A voltage buffer (aka voltage follower) is the simplest possible negative feedback ciruit you can build; you will use this circuit to demonstrate that you can <em>show</em> the 3rd golden rule to be true, given the first 2. In this circuit, <strong>all</strong> of the output is fed back into the inverting input, and the signal <span class="math inline">\(V_\text{in}\)</span> is plugged directly into the non-inverting input.</p>
         <div id="fig:buffer-intro" class="fignos">
         <figure>
         <img src="../resources/lab4fig/buffer-intro.png" style="width:10cm" alt="" /><figcaption><span>Figure 3:</span> Voltage buffer/follower (with implied power)</figcaption>
         </figure>
         </div>
         <p>Figure <a href="#fig:buffer-intro">3</a> shows a voltage buffer circuit. First notice there is no power to the op-amp in the diagram; often you’ll find op-amp example circuits without power explicitly drawn in, but op-amps <strong><em>always</em></strong> need power (the power is implied - see Figure <a href="#fig:pin-diagram">6</a> for a pinout of the LF356 Op-amp that includes the power info).</p>
         <h3 data-number="2.6.1" id="sec:4.1"><span class="header-section-number">2.6.1</span> Prelab Question</h3>
         <p>Start with <span class="math inline">\(V_\text{out}=A(V_+-V_-)\)</span>, and use the first two golden rules to show that <span class="math inline">\(G_0=1\)</span> and that <span class="math inline">\(V_+=V_-\)</span>.</p>
         <p><em>Hint:</em> Start by plugging in <span class="math inline">\(V_+=V_\text{in}\)</span> and <span class="math inline">\(V_-=V_\text{out}\)</span> and solve for <span class="math inline">\(V_\text{out}/V_\text{in}\)</span>.</p>
         <h2 data-number="2.7" id="non-inverting-amplifier"><span class="header-section-number">2.7</span> Non-Inverting Amplifier</h2>
         <p>Alongside the buffer, the non-inverting amplifier is one of the most used and simplest op-amp circuits; as the name implies, the non-inverting amplifier outputs a signal with greater amplitude than the input (without inverting it). It is very similar in design to the buffer, but with a resistor <span class="math inline">\(R_F\)</span> in the feedback loop and a resistor <span class="math inline">\(R\)</span> from the inverting input to ground. There are many ways you’ll see this diagram drawn as seen in Figure <a href="#fig:non-invert-var">4</a>. Note that sometimes people draw the inverting input on top, and sometimes on bottom, but the feedback resistor always goes to the inverting input.</p>
         <div id="fig:non-invert-var" class="fignos">
         <figure>
         <img src="../resources/lab4fig/non-inv-amp-var.png" style="width:20cm" alt="" /><figcaption><span>Figure 4:</span> Non-inverting amplifier diagram variations (all of these are the exact same circuit). Note that all of these have feedback to the negative pin.</figcaption>
         </figure>
         </div>
         <p>The two resistors form a voltage divider <em>feedback network</em> with a transfer function <span class="math inline">\(B\)</span> (think of <span class="math inline">\(R_F\)</span> as <span class="math inline">\(R_1\)</span> and <span class="math inline">\(R\)</span> as <span class="math inline">\(R_2\)</span> in the voltage divider equation from lab 2):</p>
         <p><span class="math display">\[B = \frac{R}{R_F+R}\]</span></p>
         <h3 data-number="2.7.1" id="sec:5.1"><span class="header-section-number">2.7.1</span> Prelab Question</h3>
         <p>Use golden rules 2 and 3 to show that the DC gain, <span class="math inline">\(G_0\)</span>, of the non-inverting amplifier is</p>
         <p><span class="math display">\[G_0 = \frac{1}{B} = 1 + \frac{R_F}{R}\]</span></p>
         <p><em>Hint 1:</em> First use the second golden rule and Kirchhoff’s current law to argue that the current flowing through <span class="math inline">\(R_F\)</span> is the same as the current flowing through <span class="math inline">\(R\)</span>.</p>
         <p><em>Hint 2:</em> Use Kirkhoff’s voltage rule tracing from <span class="math inline">\(V_\text{out}\)</span> to ground and from <span class="math inline">\(V_\text{in}\)</span> to ground to make two equations. You can use these to find <span class="math inline">\(V_\text{out}/V_\text{in}\)</span>.</p>
         <h3 data-number="2.7.2" id="sec:5.2"><span class="header-section-number">2.7.2</span> Prelab Question</h3>
         <p>Calculate <span class="math inline">\(G_0\)</span> and the bandwidth, <span class="math inline">\(f_B\)</span>, for the non-inverting amplifier with <span class="math inline">\(R_F = 10\ \text{k}\Omega\)</span> and <span class="math inline">\(R = 100\ \Omega\)</span> (use the <span class="math inline">\(\text{GBW}\)</span> you found in the datasheet to calculate <span class="math inline">\(f_B\)</span>). Feel free to round <span class="math inline">\(G_0\)</span> to a nice clean number ending in zero(s).</p>
         <h3 data-number="2.7.3" id="sec:5.3"><span class="header-section-number">2.7.3</span> Prelab Question</h3>
         <p>Predict the amplitude of the output voltage, <span class="math inline">\(V_\text{out}\)</span>, for the non-inverting amp with <span class="math inline">\(R_F = 10\ k\Omega\)</span> and <span class="math inline">\(R = 100\ \Omega\)</span> when</p>
         <ol type="1">
         <li><p><span class="math inline">\(V_\text{in} = 1\ \text{mV}\)</span></p></li>
         <li><p><span class="math inline">\(V_\text{in} = 1\ \text{V}\)</span></p></li>
         </ol>
         <h2 data-number="2.8" id="input-and-output-impedance-of-the-non-inverting-amplifier"><span class="header-section-number">2.8</span> Input and Output Impedance of the Non-Inverting Amplifier</h2>
         <p>The non-inverting op-amp circuit has different input impedance, <span class="math inline">\(R_i&#39;\)</span>, and output impedance, <span class="math inline">\(R_o&#39;\)</span>, from the bare op-amp. You can find the derivation for how to find <span class="math inline">\(R_i&#39;\)</span> and <span class="math inline">\(R_o&#39;\)</span> in Horowitz and Hill 2nd ed. section 4.26 (copies can be found in the lab).</p>
         <p><span class="math display">\[R_{i}&#39; = R_{i}(1 + AB)\]</span></p>
         <p><span class="math display">\[R_{o}&#39; = \frac{R_{o}}{(1 + AB)}\]</span></p>
         <p>where <span class="math inline">\(R_i\)</span> and <span class="math inline">\(R_o\)</span> are the input and output impedances of the bare op-amp (you already looked up <span class="math inline">\(R_i\)</span> in the datasheet). These impedances will be improved from the values for the bare op-amp if <span class="math inline">\(A B\)</span> is large (<span class="math inline">\(A\)</span> is large, but <span class="math inline">\(B\le 1\)</span>). With reasonable conditions, <span class="math inline">\(AB\)</span> is still quite large. Notice then that in the non-inverting amplifier configuration, negative feedback causes the input impedance to increase (from an already large value) and the output impedance to decrease (from an already small value).</p>
         <h3 data-number="2.8.1" id="sec:6.1"><span class="header-section-number">2.8.1</span> Prelab Question</h3>
         <p>The output impedance of the LF356 op-amp with no feedback is about <span class="math inline">\(40\ \Omega\)</span> (and you already found <span class="math inline">\(R_i\)</span> from the datasheet). Calculate <span class="math inline">\(R_i&#39;\)</span> and <span class="math inline">\(R_o&#39;\)</span> when <span class="math inline">\(R_F = 10\ k\Omega\)</span> and <span class="math inline">\(R = 100\ \Omega\)</span>. Does it seem reasonable to assume the input impedance is infinitely large and the output impedance is <span class="math inline">\(0\)</span>?</p>
         <h3 data-number="2.8.2" id="sec:6.2"><span class="header-section-number">2.8.2</span> Prelab Question</h3>
         <p>The oscilliscope has a finite measurement impedance <span class="math inline">\((1\text{ M}\Omega)\)</span>, so if you’re measuring <span class="math inline">\(V_\text{in}\)</span>, you are putting a resistor <span class="math inline">\(R_\text{scope}\)</span> from the input to ground (see Figure <a href="#fig:non-invert-input-measure">5</a>). This will inevitably reduce the input impedance of the amplifier. In the case when <span class="math inline">\(R_F = 10\ k\Omega\)</span> and <span class="math inline">\(R = 100\ \Omega\)</span>, what is the input impedance of the amplifier?</p>
         <p><em>Hint:</em> <span class="math inline">\(R_\text{scope}\)</span> is in parallel with <span class="math inline">\(R_o&#39;\)</span>.</p>
         <div id="fig:non-invert-input-measure" class="fignos">
         <figure>
         <img src="../resources/lab4fig/measure-input-impedance.png" style="width:10cm" alt="" /><figcaption><span>Figure 5:</span> Measuring the input changes the input impedance</figcaption>
         </figure>
         </div>
         <h3 data-number="2.8.3" id="sec:6.3"><span class="header-section-number">2.8.3</span> Prelab Question</h3>
         <p>Maybe you already noticed that the buffer is a non-inverting amplifier with <span class="math inline">\(R_F=0\)</span> and <span class="math inline">\(R=\infty\)</span>. We already know that it has a DC gain of 1, so <span class="math inline">\(B=1\)</span>. Calculate <span class="math inline">\(R_i&#39;\)</span> and <span class="math inline">\(R_o&#39;\)</span> for the buffer.</p>
         <h2 data-number="2.9" id="powering-the-op-amp"><span class="header-section-number">2.9</span> Powering the op-amp</h2>
         <p>Thus far, we’ve ignored the fact that the op-amp requires external power to operate, but the op-amp <strong><em>NEEDS</em></strong> external power to function. The recommended supply voltage to the LF356 is <span class="math inline">\(15\ \text{V}\)</span> at the positive power pin <span class="math inline">\(V^+\)</span> (aka <span class="math inline">\(+V_{cc}\)</span> or <span class="math inline">\(+V_\text{supply}\)</span>) and <span class="math inline">\(-15\ \text{V}\)</span> at the negative power pin <span class="math inline">\(V^-\)</span> (aka <span class="math inline">\(-V_{ee}\)</span> or <span class="math inline">\(-V_\text{supply}\)</span>).</p>
         <div id="fig:pin-diagram" class="fignos">
         <figure>
         <img src="../resources/lab4fig/lf356-pins.png" style="width:10cm" alt="" /><figcaption><span>Figure 6:</span> Pin diagram for LF356 (left). The numbers correspond to the corresponding pin on the DIP chip (right)</figcaption>
         </figure>
         </div>
         <p>Here we can see the pin diagram for the LF356. Don’t confuse <span class="math inline">\(V_+\)</span> and <span class="math inline">\(V^+\)</span>. The subscripts <span class="math inline">\(V_+\)</span> and <span class="math inline">\(V_-\)</span> refer to the non-inverting and inverting inputs and <span class="math inline">\(V^+\)</span> and <span class="math inline">\(V^-\)</span> refer to the power pins. Pins 2 and 3 are the inputs and 4 and 7 are for power.</p>
         <p>We always want to apply decoupling capacitors to the the power: plugging one end as close to the power pin as possible and the other end into ground. <a href="https://forum.allaboutcircuits.com/threads/decoupling-or-bypass-capacitors-why.45583/">Here’s a nice explanation why</a>.</p>
         <p><strong>Definition 9: capacitive coupling</strong> - capacitive coupling is the process of sending a signal or energy through a capacitor (remember that the impedance of a capacitor is inversely proportional to the frequency). Capacitive coupling is a way of sending AC while blocking DC. Parasitic capacitance often leads to this happening by mistake.</p>
         <p><strong>Definition 10: decoupling capacitor</strong> - decoupling is coupling to ground. Decoupling capacitors charge up and provide a reservoir of energy that can be supplied to the circuit as the circuit’s current draw changes over time. Power supplies and transmission lines have inherent inductance which impedes changes in current, <span class="math inline">\(dI/dt\)</span>, so the decoupling capacitors compensate with the energy stored and provide the current necessary to maintain constant voltage.</p>
         <div id="fig:powering-with-decouple" class="fignos">
         <figure>
         <img src="../resources/lab4fig/powering-opamp.png" style="width:8cm" alt="" /><figcaption><span>Figure 7:</span> Decoupling capacitors near the power pins are necessary for proper op-amp performance. Polarized capacitors are typically used because they can have large capacitances in a small form factor.</figcaption>
         </figure>
         </div>
         <p>Each op-amp design has limits to how much voltage you can apply to the power pins (before something breaks), and typically there is a recommended voltage that is less than this limit (e.g. the LF356 can take up to <span class="math inline">\(\pm 22\ \text{V}\)</span>, but it recommends you apply <span class="math inline">\(\pm 15\ \text{V}\)</span>). The voltage out is really coming from the power pins (the inputs, in a sense, just tell the op-amp how much of the power voltage to send to the output), so the maximum <span class="math inline">\(V_\text{out}\)</span> depends on the supply voltage.</p>
         <h3 data-number="2.9.1" id="sec:7.1"><span class="header-section-number">2.9.1</span> Prelab Question</h3>
         <p>Check the datasheet for the maximum output voltage when the LF356 is powered with <span class="math inline">\(\pm 15\ \text{V}\)</span>. This is usually referred to as the <strong>output voltage swing</strong>.</p>
         <h3 data-number="2.9.2" id="sec:7.2"><span class="header-section-number">2.9.2</span> Prelab Question</h3>
         <p>Look back at your calculations in prelab question <a href="#sec:5.3">2.7.3</a>; when supplying the LF356 with <span class="math inline">\(\pm 15\ \text{V}\)</span>, what do you expect happens when the predicted <span class="math inline">\(V_\text{out}\)</span> is greater than the output voltage swing?</p>
         <h3 data-number="2.9.3" id="sec:7.3"><span class="header-section-number">2.9.3</span> Prelab Question</h3>
         <ul>
         <li><p>There are many choices of op-amps in LTSpice. You can find them in the component’s menu (<strong><em>P</em></strong> is the shortcut). In the search bar, type “op” to open the op-amp folder. Selecting an op-amp will reveal a short description of each. In <em>most</em> cases, it doesn’t matter which you choose for your simulations, and unfortunately, the LF356, isn’t built in to the program. The OP07 (which should pop up first in the search) acts fairly ideally; however, for this activity, we will choose the OP113 since it more accurately responds to a non-ideal voltage supply.</p></li>
         <li><p>Create two voltage supplies off to the side and wire them together just like the figure below. Making them both <span class="math inline">\(+15\text{ V}\)</span> but grounding the middle will get both plus and minus voltages (just like you do with your real power supply in the lab).</p></li>
         </ul>
         <div id="fig:spice-power" class="fignos">
         <figure>
         <img src="../resources/lab4fig/spice-powering-opamp.png" style="width:10cm" alt="" /><figcaption><span>Figure 8:</span> You can use the Label Net tool to easily keep the power supply from cluttering your circuit simulation.</figcaption>
         </figure>
         </div>
         <ul>
         <li><p>Use the “Label Net” tool (it is labeled as “net” in the toolbar) to label the positive end of the power supply “supply+” and the negative end “supply-”, then you can label the two power pins of the op-amp the same (as seen in the figure above). Net labels are a way of making connections between things without having to clutter your diagram with wires. <em>Note:</em> the ground symbol is a net label as well.</p>
         <ul>
         <li><em>In the figure, the text is made to be horizontal by adding a little L-shaped tail of wire to the node. This is a stylistic choice.</em></li>
         </ul></li>
         <li><p>Make a voltage buffer circuit (see below) with a input voltage with a <span class="math inline">\(1\text{ V}\)</span> amplitude and <span class="math inline">\(1\text{ kHz}\)</span>. Set up the simulation such that about 5 oscillations will be visible (make the stop time 5 times the period).</p></li>
         <li><p>Measure the input and output voltage of the buffer. Calculate the transfer function. It should be 1.</p></li>
         <li><p>Measure the current into the op-amp at “supply+” and at “supply-”. The voltage is obviously a DC 15 (or -15) volts, but is the current DC?</p></li>
         </ul>
         <div id="fig:spice-follower" class="fignos">
         <figure>
         <img src="../resources/lab4fig/spice-follower.png" style="width:10cm" alt="" /><figcaption><span>Figure 9:</span> Voltage follower in LTSpice</figcaption>
         </figure>
         </div>
         <ul>
         <li>The simulation does not need decoupling capacitors for powering the op-amp because the voltage supplies in the simulation are <em>ideal</em>. Next we will simulate the effect of a non-ideal power supply. To do this, add inductors in series with the outputs of the power supply. The exact value isn’t very important, but <span class="math inline">\(1\text{ mH}\)</span> is a fine choice.</li>
         </ul>
         <div id="fig:spice-power-inductance" class="fignos">
         <figure>
         <img src="../resources/lab4fig/spice-non-ideal-power.png" style="height:9cm" alt="" /><figcaption><span>Figure 10:</span> A real power supply has series inductance.</figcaption>
         </figure>
         </div>
         <ul>
         <li><p>Re-run the simulation and record the results of <span class="math inline">\(V_\text{out}\)</span>. Measure and record the voltage at the power pins of the op-amp, and describe why the voltage is no longer DC.</p></li>
         <li><p>This can be resolved by adding decoupling capacitors as seen in the figure below.</p></li>
         </ul>
         <div id="fig:spice-decouple" class="fignos">
         <figure>
         <img src="../resources/lab4fig/spice-decoupling.png" style="height:10cm" alt="" /><figcaption><span>Figure 11:</span> This shows the op-amp with decoupling capacitors</figcaption>
         </figure>
         </div>
         <ul>
         <li>A good choice for capacitance here is <span class="math inline">\(1\text{ uF}\)</span> (microfarad). Re-run the simulation and report the results.</li>
         </ul>
         <h2 data-number="2.10" id="lab-activities"><span class="header-section-number">2.10</span> Lab activities</h2>
         <h3 data-number="2.10.1" id="sec:8.1"><span class="header-section-number">2.10.1</span> Prelab Question</h3>
         <p>Please review the lab activities so that you’re better prepared when you arrive to your lab section.</p>
         <h1 data-number="3" id="op-amp-tldr"><span class="header-section-number">3</span> Op-amp TLDR</h1>
         <p>This section summarizes information covered in the prelab (you may find this useful for a quick reference in the future).</p>
         <p>The op-amp is a differential amplifier that outputs an amplified difference between the inputs:</p>
         <p><span class="math display">\[V_\text{out}=A(V_+-V_-)\]</span></p>
         <p>Feeding the output back into the inverting input drives the system into a very stable state which no longer depends on many of the details or imperfections of the internal workings. <em>Closed-loop</em> refers to the state of an op-amp with feedback, and <em>open-loop</em> refers to the state of an op-amp with no feedback.</p>
         <h2 data-number="3.1" id="golden-rules"><span class="header-section-number">3.1</span> Golden Rules</h2>
         <p>The golden rules are approximations that make op-amp analysis relatively simple and straight forward.</p>
         <ol type="1">
         <li>The open-loop gain is infinitely large: <span class="math display">\[A\rightarrow\infty\]</span></li>
         <li>The input impedance is infinitely large, so no current flows in or out of the inputs: <span class="math display">\[I_+=I_-=0\]</span></li>
         <li>When negative feedback is applied, the output drives the inverting input to be the same voltage as the non-inverting input: <span class="math display">\[V_+=V_-\]</span></li>
         </ol>
         <h2 data-number="3.2" id="definitions"><span class="header-section-number">3.2</span> Definitions</h2>
         <p>Here are all the terms we defined in the prelab:</p>
         <p><strong>Open-loop gain, <span class="math inline">\(A\)</span></strong> - the gain of the op-amp when there is no feedback.</p>
         <p><strong>Open-loop DC gain, <span class="math inline">\(A_\text{VOL}\)</span></strong> - the open-loop gain at low frequencies before the frequency dependence starts to take over and the open-loop gain starts to decrease. This is cited in any op-amp datasheet (sometimes as <span class="math inline">\(A_\text{OL}\)</span> or <span class="math inline">\(A_\text{VO}\)</span>).</p>
         <p><strong>Open-loop 3 dB point, <span class="math inline">\(f_0\)</span></strong> - the frequency that the open-loop gain falls -3 dB from <span class="math inline">\(A_\text{VOL}\)</span>. Beyond this frequency, <span class="math inline">\(A\)</span> typically continues to fall with a constant dB per log-scale (quoted in dB/octave (log2) or dB/decade (log10)). This value is usually <strong><em>not</em></strong> quoted in datasheets. It can be calculated from other values, and people often aren’t concerned with the value of <span class="math inline">\(f_0\)</span>.</p>
         <p><strong>Closed-loop gain, <span class="math inline">\(G\)</span></strong> - when a fraction of the output is fed back into the inverting input <span class="math inline">\(V_-\)</span>, the op-amp’s gain is greatly reduced from <span class="math inline">\(A\)</span> to some value <span class="math inline">\(G\)</span>. Just like the open-loop gain, this value is frequency dependent and starts to fall from <span class="math inline">\(G_0\)</span> near the 3 dB point, <span class="math inline">\(f_B\)</span>.</p>
         <p><strong>Closed-loop DC gain, <span class="math inline">\(G_0\)</span></strong> - the closed-loop gain at frequencies well below the 3 dB point. Except in active filter design, the point of an op-amp is to operate at a frequency such that <span class="math inline">\(G(f)=G_0\)</span>, so almost always, the closed-loop DC gain is referred to simply as <strong><em>THE</em> gain</strong>.</p>
         <p><strong>3 dB point, <span class="math inline">\(f_B\)</span></strong> - the frequency where <span class="math inline">\(G\)</span> drops -3 dB from <span class="math inline">\(G_0\)</span>. This is also often referred to as the bandwidth or operating bandwidth, as typical operation should be done below this frequency.</p>
         <p><strong>Gain bandwidth product, <span class="math inline">\(\text{GBW}\)</span></strong> - the product of the DC gain and the 3 dB point is a constant value. This should be cited in datasheets as it’s a foundational property of each op-amp’s internal design. Just like resistor values, however, the precise <span class="math inline">\(\text{GBW}\)</span> varies from op-amp to op-amp of the same name.</p>
         <p><strong>Unity gain frequency, <span class="math inline">\(f_T\)</span></strong> - the 3 dB point when the gain is 1 (unity). Since this is mathematically equivalent to the <span class="math inline">\(\text{GBW}\)</span>, these terms are often used interchangeably.</p>
         <p><strong>Capacitive coupling</strong> - capacitive coupling is the process of sending a signal or energy through a capacitor (remember that the impedance of a capacitor is inversely proportional to the frequency). Capacitive coupling is a way of sending AC while blocking DC. Parasitic capacitance often leads to this happening by mistake.</p>
         <p><strong>Decoupling capacitor</strong> - decoupling is coupling to ground. Decoupling capacitors charge up and provide a reservoir of energy that can be supplied to the circuit as the circuit’s current draw changes over time. Power supplies and transmission lines have inherent inductance which impedes changes in current, <span class="math inline">\(dI/dt\)</span>, so the decoupling capacitors compensate with the energy stored and provide the current necessary to maintain constant voltage.</p>
         <h1 data-number="4" id="useful-readings"><span class="header-section-number">4</span> Useful Readings</h1>
         <p>You can find more on op-amps from these recommended sources:</p>
         <ol type="1">
         <li><p><a href="https://atomoptics-nas.uoregon.edu/~dsteck/teaching/electronics/electronics-notes.pdf">Steck</a> Sections 7.1, 7.2, 7.3.1, 7.3.3</p></li>
         <li><p>Fischer-Cripps Sections 12.2 - 12.15</p></li>
         <li><p>Horowitz and Hill 2<sup>nd</sup> Ed., 4.01. 4.02, 4.03, 4.05, 4.06</p></li>
         <li><p>Horowitz and Hill 3<sup>rd</sup> Ed., 4.1, 4.2.2, 4.2.3</p></li>
         <li><p>Open Circuits - 40, 52, 76</p></li>
         </ol>
         <h1 data-number="5" id="ic-tips"><span class="header-section-number">5</span> IC Tips</h1>
         <p>In this lab, we will use ICs (integrated circuits) for the first time. ICs come in many forms; we will be using DIP chips because these are designed for using in breadboards. DIP is a description of the packaging they come in: resembling little bugs with legs running down each side. These basic tips should always be followed when working with ICs. <strong>Read through them all</strong> (likely more than once) before you begin using any IC chips. You should refer back to this section in future labs to remind yourself of these useful tips.</p>
         <div id="fig:power-example" class="fignos">
         <figure>
         <img src="../resources/lab4fig/power-example.jpg" style="width:15cm" alt="" /><figcaption><span>Figure 12:</span> The LF356 op-amp DIP chip powered with plus (red) and minus (blue) voltages with decoupling capacitors. Also notice the wire jumping ground to both sides of the chip.</figcaption>
         </figure>
         </div>
         <ol type="1">
         <li>Always unplug the power supply from your circuit while you’re wiring it.</li>
         <li>Chips sit across the groove on the breadboard (see Figure <a href="#fig:power-example">12</a>). Any other placement will cause legs to short together.
         <ul>
         <li>Before inserting a chip, ensure the pins are straight (using a needle-nose pliers or something similar).</li>
         <li>After insertion, check visually that no pin is broken or bent under the chip.</li>
         <li>To remove the chip, use the dedicated IC pliers (found in the tool trays at your lab station). Removing ICs by hand often results in bent legs and/or a leg puncturing your finger.</li>
         </ul></li>
         <li>Use the long columns on your breadboard for your power and ground voltages (with power and ground next to each other) to take advantage of the parasitic decoupling capacitance of the long line.</li>
         <li>Color code your wires. We recommend:
         <ul>
         <li><p><span style="color: black;">0V (ground) Black</span></p></li>
         <li><p><span style="color: red;">+15V Red</span></p></li>
         <li><p><span style="color: blue;">-15V Blue</span></p></li>
         <li><p>Use other colors for any other connections which aren’t to <span class="math inline">\(\pm\)</span> power or ground</p></li>
         </ul></li>
         <li>Connect capacitors between the power pin(s) of the IC (as close to the pin as possible as in Figure <a href="#fig:power-example">12</a>) to ground. These are called decoupling or bypass capacitors and are critical for maintaining constant voltage at the pin as the current needs change. Use nice, big polarized (electrolytic) capacitors (<span class="math inline">\(&gt;1\ \mu\text{F}\)</span>) so that they’re able to collect enough charge to deliver the necessary current when needed.</li>
         <li>Measure all your passive elements (resistors, capacitors, inductors, diodes) before putting them in the circuits; trying to measure while they are plugged into the breadboard can lead to mistakes.</li>
         <li>Always have a diagram of your circuit with pin numbers labeled (like the left side of Figure <a href="#fig:pin-diagram">6</a>).</li>
         <li>Make sure any polarized (electrolytic) capacitors are oriented such that the higher voltage is applied to the correct lead of the capacitor. Remember: <strong>ground</strong> is a <strong><em>HIGHER</em></strong> voltage than <span class="math inline">\(-15\ \text{V}\)</span>. Getting this backward will cause the capacitor to explode: this is loud, smelly, and a bit embarrassing.</li>
         <li>Wires that your signal go through should be kept short and compact. This minimizes the parasitic inductance and capacitance and will better preserve the signal. Don’t put your signals into the long columns running down the breadboard.</li>
         <li>Don’t make any connections that cross over the top of the IC (like the feedback connection for an op-amp); instead, go around the IC.
         <ol type="1">
         <li>This makes it so you can pull out the IC without disturbing the rest of the circuit.</li>
         <li>This helps ensure magnetic fields generated by the current in the wire don’t interact with the inner workings of the IC.</li>
         </ol></li>
         <li>Compare your physical circuit to the diagram before connecting the power supply (especially polarized capacitor orientations).</li>
         </ol>
         <h1 data-number="6" id="lab-activities-1"><span class="header-section-number">6</span> Lab Activities</h1>
         <h2 data-number="6.1" id="the-function-generator-and-its-output-impedance."><span class="header-section-number">6.1</span> The Function Generator and Its Output Impedance.</h2>
         <!--Remember last week when we set the function generator to an output termination of *High Z*? We want to do this EVERY TIME we use the function generator in this class. This does not change the output impedance of the function generator: it's ALWAYS $50\ \Omega$, but by default, it *assumes* you are impedance matching everything with $50\ \Omega$ (this is important at high frequencies; feel free to ask an instructor if you're curious to hear more).

         When  the output goes through a $50\ \Omega$ load (i.e. $50\ \Omega$ termination), the voltage output will divide over the output impedance and the load, so only half the voltage will be applied to the load $\frac{50\ \Omega}{50\ \Omega+50\ \Omega} = \frac{1}{2}$. When the output termination **setting** is set to $50\ \Omega$, the device will assume half the voltage will drop across the output impedance, and display only half the voltage being applied (since this will be how much is expected to reach the $50\ \Omega$ termination). Since we won't be doing any $50\ \Omega$ impedance matching, we always want set the function generator to be in *High Z* mode and know that if the termination impedance is small, that this will voltage divide with the $50\ \Omega$ output impedance of the function generator. If you don't remember how to change this setting, refer to Appendix B in Lab 1.

         In general, the voltage out from the function generator is

         $$V_\text{out}=\frac{R_\text{termination}}{50\ \Omega+R_\text{termination}}V_\text{displayed}$$

         For large termination impedance, clearly the voltage out will be the same as what is displayed on the screen; however, we can see a clear issue: if the termination impedance is smaller than $50\ \Omega$, less than half of the voltage actually exits the function generator.

         This next activity will demonstrate how this can be a problem in order to motivate the use of an op-amp as a voltage buffer. You will try to play a note through a speaker directly from the function generator.

         1.  Grab a speaker and use your DMM to measure the resistance of the speaker.

         2.  Set up the function generator and the oscilliscope.

             1.  Set the output impedance on the function generator to *High Z*.

             2.  Set up the function generator and the oscilloscope so that you can read Channel 1 from the function generator with Channel 1 of the oscilloscope (use a BNC T-connector so that later you can eventually connect this to your breadboard as well).

             3.  Connect the *Sync* on the function generator with Channel 4 of the oscilloscope.

             4.  Create a $400\ \text{mV}_\text{pp}$ sine wave with a $432\ \text{Hz}$ frequency and trigger on the *Sync* (in the trigger menu, change the channel to Channel 4). This will provide a nice lower frequency tone (a $\text{C}_4$ note) at a volume that won't be too obnoxious to your neighbors.

         3.  Confirm on the oscilliscope that the frequency and the amplitude of your wave match the settings on the function generator.

         3.  Apply the signal from the function generator to the speaker (use the T-connector, so you can still see it on the oscilloscope).

             1.  Now what is the amplitude of the sine wave on Channel 1 of the oscilliscope?

             2.  Why did the amplitude change after applying the load to the function generator's output? Unplug the BNC connector from the breadboard's header: did the amplitude recover? Why? Reconnect the function generator to your circuit and confirm the voltage drops.

             3.  What is the transfer function of the voltage before plugging it into the circuit divided by voltage after plugging into the circuit?

             2.  Draw a full circuit diagram which describes why this behavior is happening. *Hint*: there should be 3 resistors: the output impedance of the function generator, the impedance of the speaker, and the input impedance of the oscilliscope.

         Since the impedance of the speaker can't be changed, in order to get the full voltage to the speaker, you will have to decrease the output impedance. This can be done with a voltage buffer.-->
         <h2 data-number="6.2" id="building-an-op-amp-test-circuit"><span class="header-section-number">6.2</span> Building an op-amp test circuit</h2>
         <p>Before you build any useful op-amp circuits, let’s build a simple means to test if an op-amp chip is functioning.</p>
         <p>When building circuits, it’s a good idea to test components before putting them all together in a complex circuit. This can save you a lot of headaches by avoiding needing to debug your circuit because you have a burnt out or broken IC.</p>
         <p>You should consider leaving the “bones” of this test circuit somewhere on your breadboard so that you can quickly pop in an LF356 chip to test it (keep it compact and leave plenty of space on your breadboard for future work).</p>
         <div id="fig:voltage-follower-gnd" class="fignos">
         <figure>
         <img src="../resources/lab4fig/voltage-follower-gnd.png" style="width:10cm" alt="" /><figcaption><span>Figure 13:</span> The test circuit is voltage buffer (follower) with a grounded input.</figcaption>
         </figure>
         </div>
         <p>The test circuit resembles the buffer, but with <span class="math inline">\(V_\text{in}=0\)</span>.</p>
         <ol type="1">
         <li><p>Predict the voltage at pins 2, 3, 4, 6, and 7 of the test circuit.</p></li>
         <li><p>Build the test circuit as shown above (review the IC tips).</p></li>
         <li><p>Measure and record the voltages at pins 2, 3, 4, 6, and 7. Do they match your predictions? If not, revise your predictions or decide that the op-amp is broken. Check in with an instructor if you are unsure.</p></li>
         </ol>
         <p>Commonly, when a chip isn’t working, it will output roughly <span class="math inline">\(15\ \text{V}\)</span> or <span class="math inline">\(-15\ \text{V}\)</span> at pin 6 regardless of the configuration. If you find you have a bad chip, throw it in the trash and grab another (In case you are wondering, the LF356 costs less than $1). If you’re not sure, grab an instructor and have them take a look with you.</p>
         <h2 data-number="6.3" id="voltage-buffer"><span class="header-section-number">6.3</span> Voltage Buffer</h2>
         <div id="fig:voltage-follower" class="fignos">
         <figure>
         <img src="../resources/lab4fig/voltage-follower.png" style="width:10cm" alt="" /><figcaption><span>Figure 14:</span> Voltage buffer (aka voltage follower)</figcaption>
         </figure>
         </div>
         <p>A voltage buffer is an incredibly useful circuit which isolates an input voltage from the driving output, allowing you to drive loads from the function generator without drawing any current from it (the current will be sourced from the power supply instead). Two weeks ago, you tried to power a speaker directly with the function generator and found that too much of the voltage divides over the output impedance for it to be useful. The follower will allow you to overcome this limitation of the function generator.</p>
         <p>The voltage buffer is essentially a non-inverting amplifier with a gain of 1, so it is often also referred to as a follower (since the output “follows” the input). The buffer gets its name because no current flows through the input and therefore the voltage at the output is, in a sense, <em>isolated</em> from the voltage at the input (even though they’re the same value). This can help you avoid unintended issues with voltage dividers: such as the one you encountered above with the function generator, as well as having measurement impedances or loads in parallel with a voltage divider changing how much current goes through <span class="math inline">\(R_2\)</span> (you also encountered this in Lab 2).</p>
         <p>You will use the buffer to take the output of the function generator (with a <span class="math inline">\(50\ \Omega\)</span> output impedance) and reproduce (i.e. follow) the same voltage with a very small output impedance (we calculated this in prelab question <a href="#sec:6.3">2.8.3</a>)</p>
         <div id="fig:op-amp-test" class="fignos">
         <figure>
         <img src="../resources/lab4fig/op-amp-test.png" style="width:15cm" alt="" /><figcaption><span>Figure 15:</span> Test and measurement setup for op-amp circuits</figcaption>
         </figure>
         </div>
         <ol type="1">
         <li><p>Build the voltage follower using the function generator as <span class="math inline">\(V_\text{in}\)</span>. You will use the same settings as before (<span class="math inline">\(400\text{ mV}_\text{pp}\)</span> sine wave at <span class="math inline">\(432\text{ Hz}\)</span>). Figure <a href="#fig:op-amp-test">15</a> shows a schematic of the full set up using Channel 1 to measure <span class="math inline">\(V_\text{in}\)</span>, Channel 2 to measure <span class="math inline">\(V_\text{out}\)</span>, and Channel 4 to trigger on the <em>Sync</em> output.</p></li>
         <li><p>Confirm the gain is <span class="math inline">\(1\)</span>. If the gain is <span class="math inline">\(10\)</span> or <span class="math inline">\(0.1\)</span>, this is likely due to a setting on the oscilliscope (ask for help if you’re lost).</p></li>
         <li><p>Connect the speaker from <span class="math inline">\(V_\text{out}\)</span> to ground. Does <span class="math inline">\(V_\text{in}\)</span> or <span class="math inline">\(V_\text{out}\)</span> change?</p></li>
         <li><p>Why or why not? Is this expected?</p></li>
         <li><p>Increase the amplitude on the function generator to <span class="math inline">\(500\text{ mV}_\text{pp}\)</span>. Describe what happens to <span class="math inline">\(V_\text{out}\)</span>.</p></li>
         <li><p>Play with the amplitude to see if this behavior is consistent. Record what you’re doing and what you’re seeing along the way.</p></li>
         <li><p>Why is this happening? Is this consistent with what you found in the prelab? This is a good place to check in with an instructor to confirm your thinking or clear up any confusion.</p></li>
         <li><p>Unplug your speaker!</p></li>
         </ol>
         <p>There are op-amps which have higher max output currents. These are sometimes referred to as “power op-amps” and are in form factors designed to attach to heat sinks (since high currents produce a lot of heat).</p>
         <!--

         ## Unity gain frequency

         1.  You found the gain bandwidth product in the prelab. What is the unity gain frequency?

         2.  We will be going up to high frequencies, so it will be ideal to use a scope-probe on Channel 2 to measure $V_\text{out}$. What setting on the oscilliscope do you need to change when you do this?

         3.  Set the function generator to the unity gain frequency that you found. Are you seeing a -3 dB reduction in the output at this frequency?

         4.  Pick 3 frequencies between the unity gain frequency and the highest frequency the function generator can put out; record the gain and describe anything else interesting you see. 

         At very high frequencies, circuit models typically become more complicated. For example, parasitic capacitance and inductance due to the exact physical configuration start to play more substantial roles in behavior. The details of the physical layout of a PCB start to become crucial, and often people think less about voltages and currents and consider the circuit as a waveguide for EM waves. Additionally, op-amps themselves no longer acts ideally at high frequencies. 

         5.  You are unlikely to find a simple RC filter type falloff. Using the 10X scope-probe, measure the gain at every decade in frequency from 10 MHz down to 10 Hz, with (as usual) a few extra points anywhere things are starting to change. Do you find any deviation from unity gain? HINT: Be sure that the output amplitude is below the level affected by the slew rate. For more on slew rate, see Horowitz and Hill 2nd ed. section 4.11 p. 192 or 3rd ed. section 4.4 p 242. Plot the low and high frequency data and predicted behavior on your Bode plot from your prelab. Do you find a simple fall-off as suggested by the theory for the ideal follower ($f_T=f_B$)? If so, find the 3 dB frequency. How does your measured 3 dB frequency compare to what is expected from the op-amp datasheet?

         6.  If you observed ideal behavior, you're lucky! At frequencies above a few MHz, the simple model of the frequency response of the op-amp is not accurate. Once you are in this frequency range, many physical details of your circuit and breadboard can have large effects in the circuit (see notes in 7.1.4 above). You could model these effects, but a better procedure to follow is to modify the physical setup. Building reliable circuits at these frequencies typically requires careful attention to grounding and minimization of capacitive and inductive coupling between circuit elements and to ground. Printed circuit boards are much better for high-frequency applications. At lower frequencies, our model of the circuit will work much better.

         -->
         <h2 data-number="6.4" id="non-inverting-amplifier-1"><span class="header-section-number">6.4</span> Non-Inverting Amplifier</h2>
         <div id="fig:non-inv-amp" class="fignos">
         <figure>
         <img src="../resources/lab4fig/non-inv-amp.png" style="width:15cm" alt="" /><figcaption><span>Figure 16:</span> Non-inverting amplifier</figcaption>
         </figure>
         </div>
         <ol type="1">
         <li><p>Grab a <span class="math inline">\(10\text{ k}\Omega\)</span> and a <span class="math inline">\(100\ \Omega\)</span> resistor and measure their resistances.</p></li>
         <li><p>Change the negative feedback loop in your circuit to the one shown in Figure <a href="#fig:non-inv-amp">16</a>, with <span class="math inline">\(R_F = 10\text{ k}\Omega\)</span> and <span class="math inline">\(R = 100\ \Omega\)</span> (or build a new one elsewhere on your breadboard).</p></li>
         <li><p>You calculated <span class="math inline">\(G_0\)</span> and <span class="math inline">\(f_B\)</span> for this circuit in the prelab, recalculate these values for the measured values of <span class="math inline">\(R\)</span> and <span class="math inline">\(R_F\)</span>.</p></li>
         <li><p>What’s a reasonable amplitude to set for <span class="math inline">\(V_\text{in}\)</span>? Why? Set the function generator to this.</p></li>
         <li><p>What’s a reasonable frequency to set so that <span class="math inline">\(G(f)=G_0\)</span>? Why? Set the function generator to this. (consider the gain bandwidth product and/or your Bode plots).</p></li>
         <li><p>Measure the amplitude of <span class="math inline">\(V_\text{in}\)</span> and <span class="math inline">\(V_\text{out}\)</span> and then calculate the gain. How does this compare to your prediction?</p></li>
         </ol>
         <h3 data-number="6.4.1" id="frequency-limitations-of-the-amplifier"><span class="header-section-number">6.4.1</span> Frequency limitations of the amplifier</h3>
         <ol type="1">
         <li><p>Set the frequency to the calculated 3 dB frequency and measure the gain. Is this -3 dB less than the previous gain? If not, change the frequency until you find the frequency at which the gain is -3 dB less than <span class="math inline">\(G_0\)</span>. What is the measured 3 dB frequency?</p></li>
         <li><p>Use the previous result to calculate the gain bandwidth product. How does this compare to the datasheet?</p></li>
         <li><p>Record measurements of the gain and frequency at a few points near the 3 dB frequency, a point roughly an order of magnitude above and below, and a point roughly two orders of magnitude above and below.</p></li>
         <li><p>Make a new Bode plot based on your updated Gain Bandwidth Product along with these data points. Do your measurements agree with the model?</p></li>
         </ol>
         <h3 data-number="6.4.2" id="output-voltage-limitations-of-the-amplifier"><span class="header-section-number">6.4.2</span> Output voltage limitations of the amplifier</h3>
         <ol type="1">
         <li><p>Return the frequency to a “low” frequency when <span class="math inline">\(G=G_0\)</span>. Increase the voltage until you see the signal saturate (this is also referred to as clipping). Measure the output saturation levels, <span class="math inline">\(+V_\text{sat}\)</span> and <span class="math inline">\(–V_\text{sat}\)</span>? Record how you determined <span class="math inline">\(V_\text{sat}\)</span>. Can <span class="math inline">\(V_\text{out}\)</span> produce voltages that span the voltages applied (<span class="math inline">\(-15\text{ V}\)</span> to <span class="math inline">\(+15\text{ V}\)</span>) to the op-amp?</p></li>
         <li><p>The model of the op-amp you have been working with does not include saturation effects. To make sure you are working within the range where your model is most accurate, make sure the output amplitude is below half the saturated value. Change the amplitude of the input so that the output is within this range.</p></li>
         </ol>
         <h3 data-number="6.4.3" id="input-impedance-of-the-amplifier"><span class="header-section-number">6.4.3</span> Input impedance of the amplifier</h3>
         <ol type="1">
         <li>Unplug <span class="math inline">\(V_\text{in}\)</span> from the oscilloscope so that the input impedance is the full <span class="math inline">\(R_o&#39;\)</span> calculated in the prelab. Predict what happens if you add a <span class="math inline">\(1\text{ M}\Omega\)</span> resistor in series with <span class="math inline">\(V_\text{in}\)</span>. <em>Hint:</em> consider the voltage drop across the resistor, and consider how adding this resistor changes in the input impedance. Do your measurements agree with your predictions?</li>
         </ol>
         <div id="fig:non-inv-amp1" class="fignos">
         <figure>
         <img src="../resources/lab4fig/increasing-input-impedance.png" style="width:15cm" alt="" /><figcaption><span>Figure 17:</span> Will this resistor affect the circuit?</figcaption>
         </figure>
         </div>
         <h3 data-number="6.4.4" id="output-impedance-of-the-amplifier"><span class="header-section-number">6.4.4</span> Output impedance of the amplifier</h3>
         <ol type="1">
         <li><p>Consider driving a load with resistance <span class="math inline">\(R_L\)</span> with the output of your amplifier and the effects of the output impedance <span class="math inline">\(R_o&#39;\)</span>. Write a relation between the amount of <span class="math inline">\(V_\text{out}\)</span> makes it across <span class="math inline">\(R_L\)</span> as a function of <span class="math inline">\(R_L\)</span>.</p></li>
         <li><p>Predict the maximum <span class="math inline">\(V_\text{in}\)</span> you can use to avoid hitting the maximum output current when <span class="math inline">\(R_L\)</span> is equal to the resistance you measured for the speaker (don’t forget to consider the output impedance). Set the input to be just less than this, and set the frequency back to a <span class="math inline">\(\text{C}_4\)</span> note <span class="math inline">\((432\ \text{Hz})\)</span>.</p></li>
         <li><p>Record <span class="math inline">\(V_\text{out}\)</span> and confirm the gain is what you expect.</p></li>
         <li><p>Plug in the speaker. Record <span class="math inline">\(V_\text{out}\)</span> again. Did <span class="math inline">\(V_\text{out}\)</span> change? By how much?</p></li>
         <li><p>We can refer to the output when a load is attached as <span class="math inline">\(V_\text{out}^{(L)}\)</span> and <span class="math inline">\(V_\text{out}\)</span> as the output when no load attached. Use the ratio of <span class="math inline">\(\frac{V_\text{out}^{(L)}}{V_\text{out}}\)</span> to calculate the output impedance of the non-inverting amplifier.</p></li>
         <li><p>If you wanted all of the output to drop across the load instead of having a significant portion drop across the output impedance, what changes could you make to the circuit, or what elements could you add to achieve the same gain but with lower output impedance?</p></li>
         </ol>
               </div>
            <!-- Mathjax -->
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script>

      </script>
   </body>
</html>
